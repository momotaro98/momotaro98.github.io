<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Check and Fix tool Go import paths are sorted more strictly than goimports - Dig Sky</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Check and Fix tool Go import paths are sorted more strictly than goimports">
<meta itemprop="description" content="Introduction In this article I will share Golang checker tool I created. The tool checks import paths are sorted &ldquo;strictly&rdquo;.
Here&rsquo;s the tool repository link.
https://github.com/momotaro98/strictimportsort
The issue goimports supports -local flag when we have local path.
When we have such an import paths.
import ( &#34;errors&#34; &#34;github.com/google/wire&#34; &#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34; ) Then run goimports with -local flag
$ goimports -local &#34;github.com/momotaro98&#34; . The files are sorted with whilte line like following.">
<meta itemprop="datePublished" content="2020-05-30T22:18:31&#43;09:00" />
<meta itemprop="dateModified" content="2020-05-30T22:18:31&#43;09:00" />
<meta itemprop="wordCount" content="280">



<meta itemprop="keywords" content="Go," /><meta property="og:title" content="Check and Fix tool Go import paths are sorted more strictly than goimports" />
<meta property="og:description" content="Introduction In this article I will share Golang checker tool I created. The tool checks import paths are sorted &ldquo;strictly&rdquo;.
Here&rsquo;s the tool repository link.
https://github.com/momotaro98/strictimportsort
The issue goimports supports -local flag when we have local path.
When we have such an import paths.
import ( &#34;errors&#34; &#34;github.com/google/wire&#34; &#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34; ) Then run goimports with -local flag
$ goimports -local &#34;github.com/momotaro98&#34; . The files are sorted with whilte line like following." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://momotaro98.github.io/posts/ee2c33f5e53e3c88a15f/" />
<meta property="article:published_time" content="2020-05-30T22:18:31+09:00" />
<meta property="article:modified_time" content="2020-05-30T22:18:31+09:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Check and Fix tool Go import paths are sorted more strictly than goimports"/>
<meta name="twitter:description" content="Introduction In this article I will share Golang checker tool I created. The tool checks import paths are sorted &ldquo;strictly&rdquo;.
Here&rsquo;s the tool repository link.
https://github.com/momotaro98/strictimportsort
The issue goimports supports -local flag when we have local path.
When we have such an import paths.
import ( &#34;errors&#34; &#34;github.com/google/wire&#34; &#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34; ) Then run goimports with -local flag
$ goimports -local &#34;github.com/momotaro98&#34; . The files are sorted with whilte line like following."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://momotaro98.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://momotaro98.github.io/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://momotaro98.github.io/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://momotaro98.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://momotaro98.github.io/">
				<img src="https://pbs.twimg.com/profile_images/1248275936392269824/R7SvHgrz_400x400.jpg" alt="Dig Sky" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://momotaro98.github.io/">Dig Sky</a></h1>
	<div class="site-description"><p>Webエンジニアがひっそり語るぼやき</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/momotaro98" title="GitHub"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/jhtarosan" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/shintaro-ikeda-8382b2118/" title="LinkedIn"><i data-feather="linkedin"></i></a></li><li><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav><span class="scheme-toggle"><a href="#" id="scheme-toggle"></a></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">30</span>
							<span class="rest">May 2020</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Check and Fix tool Go import paths are sorted more strictly than goimports</h1>
				</div>
			</div>
					
			<div class="markdown">
				<h2 id="introduction">Introduction</h2>
<p>In this article I will share Golang checker tool I created. The tool checks import paths are sorted &ldquo;strictly&rdquo;.</p>
<p>Here&rsquo;s the tool repository link.</p>
<p><a href="https://github.com/momotaro98/strictimportsort">https://github.com/momotaro98/strictimportsort</a></p>
<h2 id="the-issue">The issue</h2>
<p>goimports supports <code>-local</code> flag when we have local path.</p>
<p>When we have such an import paths.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#00f">import</span> (
    <span style="color:#a31515">&#34;errors&#34;</span>
    <span style="color:#a31515">&#34;github.com/google/wire&#34;</span>
    <span style="color:#a31515">&#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34;</span>
)
</code></pre></div><p>Then run goimports with <code>-local</code> flag</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ goimports -local &#34;github.com/momotaro98&#34; .
</code></pre></div><p>The files are sorted with whilte line like following.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#00f">import</span> (
    <span style="color:#a31515">&#34;errors&#34;</span>

    <span style="color:#a31515">&#34;github.com/google/wire&#34;</span>
    
    <span style="color:#a31515">&#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34;</span>
)
</code></pre></div><p>However, when we have a go file whose import paths are separate with white line in advance, <code>goimports</code> doesn&rsquo;t support sorting for the file.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#00f">import</span> (
    <span style="color:#a31515">&#34;errors&#34;</span>

    <span style="color:#a31515">&#34;github.com/momotaro98/mixlunch-service-api/partyservice&#34;</span>

    <span style="color:#a31515">&#34;github.com/google/wire&#34;</span>
)
</code></pre></div><p>When I use GoLand IDE, it sometimes makes white line separate import paths like above.</p>
<p>I expected &ldquo;github.com/momotaro98&rdquo; is at last but goimports regards it&rsquo;s fine since it already has a white line.</p>
<h2 id="tool-i-made">Tool I made</h2>
<p><a href="https://github.com/momotaro98/strictimportsort">strictimportsort</a> is a checker tool you can check go files whose import paths are not sorted &ldquo;strictly&rdquo;.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ strictimportsort -exclude &#34;*_mock.go,*.pb.go&#34; -exclude-dir &#34;testmock&#34; -local &#34;github.com/momotaro98&#34; .
</code></pre></div><p>Command line tool supports <code>-exclude</code>, <code>-exclude-dir</code> flag and <code>-local</code> flag as well as goimports.</p>
<p>We can see instruction output when there&rsquo;s such &ldquo;not sorted strictly&rdquo; files with file names, line number, and column number like followings.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/Users/shintaro/.ghq/github.com/momotaro98/mixlunch-service-api/partyservice/domain_test.go:8:2: import not sorted correctly. should be replace to
import (
        &#34;errors&#34;
        &#34;testing&#34;
        &#34;time&#34;

        &#34;github.com/golang/mock/gomock&#34;

        &#34;github.com/momotaro98/mixlunch-service-api/userservice&#34;
        &#34;github.com/momotaro98/mixlunch-service-api/utils&#34;
)
/Users/shintaro/.ghq/github.com/momotaro98/mixlunch-service-api/userservice/provider.go:5:2: import not sorted correctly. should be replace to
import (
        &#34;github.com/google/wire&#34;

        &#34;github.com/momotaro98/mixlunch-service-api/tagservice&#34;
)
</code></pre></div><h2 id="you-can-modify-the-target-files-with--w-option">You can modify the target files with <code>-w</code> option.</h2>
<p>We can modify the target files by using <code>-w</code> option.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ strictimportsort -w -exclude &#34;*_mock.go,*.pb.go&#34; -exclude-dir &#34;testmock&#34; -local &#34;github.com/momotaro98&#34; .
</code></pre></div><p>Just adding the <code>-w</code> option, strictimportsort modifies the target files and doesn&rsquo;t show the results.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/go">Go</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2020  © momotaro98 |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-165392475-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-165392475-1');
</script>

<script>feather.replace()</script>
</body>
</html>
